@using Microsoft.AspNetCore.Mvc.TagHelpers
@using IntelliTest.Services.Infrastructure
@using IntelliTest.Core.Contracts
@model IEnumerable<LessonViewModel>
@{
    ViewBag.Title = "Tests Blog";
}

<div class="container" style="margin-top: 30px">
    <div class="row">
        <h2 style="text-align: center;" id="lessonHeading">Уроци</h2>
        <div class="floating-container">
            <a class="floating-button" asp-action="Create">+</a>
        </div>
        <div class="col-lg-12 mb-3">
            @if (Model.Count() != 0)
            {
                    <div class="row text-left mb-5">
                    <div class="col-lg-4 mb-3 mb-sm-0">
                        <div class="dropdown form-control form-control-lg bg-white bg-op-9 text-sm w-lg-50" style="width: 100%; height: 100%;">
                            <select class="form-control form-control-lg bg-white bg-op-9 text-sm w-lg-50" data-toggle="select" tabindex="-98">
                                <option> Categories </option>
                                <option> Learn </option>
                                <option> Share </option>
                                <option> Build </option>
                            </select>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="dropdown form-control form-control-lg bg-white bg-op-9 ml-auto text-sm w-lg-50" style="width: 100%; height: 100%;">
                            <select class="form-control form-control-lg bg-white bg-op-9 ml-auto text-sm w-lg-50" data-toggle="select" tabindex="-98">
                                <option> Filter by </option>
                                <option> Votes </option>
                                <option> Replys </option>
                                <option> Views </option>
                            </select>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="dropdown bootstrap-select form-control form-control-lg bg-white" style="width: 100%; height: 100%;">
                            <select class="form-control form-control-lg bg-white" data-toggle="select" tabindex="-98">
                                <option> Grade</option>
                                @for (int i = 1; i <= 12; i++)
                                {
                                        <option>@i</option>
                                }
                            </select>
                        </div>
                    </div>
                </div>
                <div class="questBoxHover questBox card py-3 px-3 mb-3 border-top-0 border-bottom-0" style="width: 100%">
                    @foreach (var lesson in Model)
                    {
                            <partial name="~/Views/Lessons/LessonPartialView.cshtml" model="lesson"/>
                    }
                </div>
            }
            else
            {
                <h2 style="text-align: center">Няма резултати...</h2>
            }
        </div>
    </div>
</div>
<script>
    var root = document.querySelector(":root");

    root.style.fontSize = "16px";
    function onLike(e){
        if (e.style.backgroundPositionX === "-2800px"){
            $.ajax({
              type: 'get',
              url: `/Lessons/Unlike?lessonId=${e.id}&userId=@User.Id()`
            });
            e.parentNode.children[1].textContent = parseInt(e.parentNode.children[1].textContent.replace(" Likes", ""))-1 + " Likes";
            e.style.transitionDuration = "0s";
            e.style.backgroundPosition = '0 0';
        }
        else{
            $.ajax({
              type: 'get',
              url: `/Lessons/Like?lessonId=${e.id}&userId=@User.Id()`
            });
            e.parentNode.children[1].textContent = parseInt(e.parentNode.children[1].textContent.replace(" Likes", ""))+1 + " Likes";
            e.style.transitionDuration = "1s";
            e.style.backgroundPosition = '-2800px 0';
        }
    }
</script>